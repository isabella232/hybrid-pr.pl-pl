---
title: FootFall — wzorzec wykrywania przy użyciu platformy Azure i usługi Azure Stack Hub
description: Dowiedz się, jak korzystać z platformy Azure i usługi Azure Stack Hub, aby wdrożyć rozwiązanie wykrywania FootFall oparte na systemie AI do analizowania ruchu w sklepie detalicznym.
author: BryanLa
ms.topic: article
ms.date: 10/31/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 10/31/2019
ms.openlocfilehash: 866557ec3af2337e9f034da84cf417675508563b
ms.sourcegitcommit: 962334135b63ac99c715e7bc8fb9282648ba63c9
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/23/2021
ms.locfileid: "104895333"
---
# <a name="footfall-detection-pattern"></a><span data-ttu-id="b24c5-103">FootFall — wzorzec wykrywania</span><span class="sxs-lookup"><span data-stu-id="b24c5-103">Footfall detection pattern</span></span>

<span data-ttu-id="b24c5-104">Ten wzorzec zawiera przegląd dotyczący implementacji rozwiązania wykrywania FootFall opartego na formacie AI do analizowania ruchu odwiedzających w sklepach detalicznych.</span><span class="sxs-lookup"><span data-stu-id="b24c5-104">This pattern provides an overview for implementing an AI-based footfall detection solution for analyzing visitor traffic in retail stores.</span></span> <span data-ttu-id="b24c5-105">Rozwiązanie generuje wgląd w dane z rzeczywistych działań świata przy użyciu platformy Azure, Azure Stack Hub oraz zestawu Custom Vision AI.</span><span class="sxs-lookup"><span data-stu-id="b24c5-105">The solution generates insights from real world actions, using Azure, Azure Stack Hub, and the Custom Vision AI Dev Kit.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="b24c5-106">Kontekst i problem</span><span class="sxs-lookup"><span data-stu-id="b24c5-106">Context and problem</span></span>

<span data-ttu-id="b24c5-107">Magazyny firmy Contoso mają wgląd w informacje dotyczące sposobu, w jaki klienci otrzymują swoje bieżące produkty w odniesieniu do układu sklepu.</span><span class="sxs-lookup"><span data-stu-id="b24c5-107">Contoso Stores would like to gain insights on how customers are receiving their current products in relation to store layout.</span></span> <span data-ttu-id="b24c5-108">Nie są w stanie umieścić pracowników w każdej sekcji i nie jest wydajny, aby zespół analityków przeglądał materiał z kamerą całego sklepu.</span><span class="sxs-lookup"><span data-stu-id="b24c5-108">They're unable to place staff in every section and it's inefficient to have a team of analysts review an entire store's camera footage.</span></span> <span data-ttu-id="b24c5-109">Ponadto żaden z ich magazynów nie ma wystarczającej przepustowości do przesyłania strumieniowego wideo ze wszystkich kamer do chmury w celu przeprowadzenia analizy.</span><span class="sxs-lookup"><span data-stu-id="b24c5-109">In addition, none of their stores have enough bandwidth to stream video from all their cameras to the cloud for analysis.</span></span>

<span data-ttu-id="b24c5-110">Firma Contoso chce znaleźć niezauważalny, przyjazny dla prywatności sposób określania demograficznych klientów, lojalności i reakcji na przechowywanie wyświetlanych i produktów.</span><span class="sxs-lookup"><span data-stu-id="b24c5-110">Contoso would like to find an unobtrusive, privacy-friendly way to determine their customers' demographics, loyalty, and reactions to store displays and products.</span></span>

## <a name="solution"></a><span data-ttu-id="b24c5-111">Rozwiązanie</span><span class="sxs-lookup"><span data-stu-id="b24c5-111">Solution</span></span>

<span data-ttu-id="b24c5-112">Ten wzorzec analizy handlu detalicznego używa podejścia warstwowego do inferencing na brzegu.</span><span class="sxs-lookup"><span data-stu-id="b24c5-112">This retail analytics pattern uses a tiered approach to inferencing at the edge.</span></span> <span data-ttu-id="b24c5-113">Korzystając z zestawu Custom Vision AI dev Kit, do analizy są wysyłane tylko obrazy ze ludzkich twarzy do usługi Private Azure Stack Hub, na których działa usługa Azure Cognitive Services.</span><span class="sxs-lookup"><span data-stu-id="b24c5-113">By using the Custom Vision AI Dev Kit, only images with human faces are sent for analysis to a private Azure Stack Hub that runs Azure Cognitive Services.</span></span> <span data-ttu-id="b24c5-114">Anonimowe dane zagregowane są wysyłane do platformy Azure w celu agregacji we wszystkich sklepach i wizualizacji w Power BI.</span><span class="sxs-lookup"><span data-stu-id="b24c5-114">Anonymized, aggregated data is sent to Azure for aggregation across all stores and visualization in Power BI.</span></span> <span data-ttu-id="b24c5-115">Łączenie z usługą Edge i chmurą publiczną pozwala firmie Contoso korzystać z nowoczesnej technologii AI, a także zachować zgodność z zasadami firmowymi i przestrzegać poufności swoich klientów.</span><span class="sxs-lookup"><span data-stu-id="b24c5-115">Combining the edge and public cloud lets Contoso take advantage of modern AI technology while also remaining in compliance with their corporate policies and respecting their customers' privacy.</span></span>

<span data-ttu-id="b24c5-116">[![Rozwiązanie do tworzenia wzorców wykrywania FootFall](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span><span class="sxs-lookup"><span data-stu-id="b24c5-116">[![Footfall detection pattern solution](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span></span>

<span data-ttu-id="b24c5-117">Oto podsumowanie sposobu działania rozwiązania:</span><span class="sxs-lookup"><span data-stu-id="b24c5-117">Here's a summary of how the solution works:</span></span>

1. <span data-ttu-id="b24c5-118">Custom Vision AI dev Kit Pobiera konfigurację z IoT Hub, która instaluje IoT Edge środowiska uruchomieniowego i modelu ML.</span><span class="sxs-lookup"><span data-stu-id="b24c5-118">The Custom Vision AI Dev Kit gets a configuration from IoT Hub, which installs the IoT Edge Runtime and an ML model.</span></span>
2. <span data-ttu-id="b24c5-119">Jeśli model widzi osobę, pobiera obraz i przekazuje go do Azure Stack centrum obiektów BLOB Storage.</span><span class="sxs-lookup"><span data-stu-id="b24c5-119">If the model sees a person, it takes a picture and uploads it to Azure Stack Hub blob storage.</span></span>
3. <span data-ttu-id="b24c5-120">Usługa BLOB Service wyzwala funkcję platformy Azure w centrum Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="b24c5-120">The blob service triggers an Azure Function on Azure Stack Hub.</span></span>
4. <span data-ttu-id="b24c5-121">Funkcja platformy Azure wywołuje kontener z Face API, aby uzyskać dane demograficzne i rozpoznawania emocji z obrazu.</span><span class="sxs-lookup"><span data-stu-id="b24c5-121">The Azure Function calls a container with the Face API to get demographic and emotion data from the image.</span></span>
5. <span data-ttu-id="b24c5-122">Dane są anonimowe i wysyłane do klastra Event Hubs platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="b24c5-122">The data is anonymized and sent to an Azure Event Hubs cluster.</span></span>
6. <span data-ttu-id="b24c5-123">Klaster Event Hubs wypycha dane, aby Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="b24c5-123">The Event Hubs cluster pushes the data to Stream Analytics.</span></span>
7. <span data-ttu-id="b24c5-124">Stream Analytics agreguje dane i wypycha je do Power BI.</span><span class="sxs-lookup"><span data-stu-id="b24c5-124">Stream Analytics aggregates the data and pushes it to Power BI.</span></span>

## <a name="components"></a><span data-ttu-id="b24c5-125">Składniki</span><span class="sxs-lookup"><span data-stu-id="b24c5-125">Components</span></span>

<span data-ttu-id="b24c5-126">To rozwiązanie używa następujących składników:</span><span class="sxs-lookup"><span data-stu-id="b24c5-126">This solution uses the following components:</span></span>

| <span data-ttu-id="b24c5-127">Warstwa</span><span class="sxs-lookup"><span data-stu-id="b24c5-127">Layer</span></span> | <span data-ttu-id="b24c5-128">Składnik</span><span class="sxs-lookup"><span data-stu-id="b24c5-128">Component</span></span> | <span data-ttu-id="b24c5-129">Opis</span><span class="sxs-lookup"><span data-stu-id="b24c5-129">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="b24c5-130">Sprzęt w sklepie</span><span class="sxs-lookup"><span data-stu-id="b24c5-130">In-store hardware</span></span> | [<span data-ttu-id="b24c5-131">Custom Vision AI</span><span class="sxs-lookup"><span data-stu-id="b24c5-131">Custom Vision AI Dev Kit</span></span>](https://azure.github.io/Vision-AI-DevKit-Pages/) | <span data-ttu-id="b24c5-132">Zapewnia filtrowanie w sklepie przy użyciu lokalnego modelu ML, który przechwytuje tylko obrazy osób do analizy.</span><span class="sxs-lookup"><span data-stu-id="b24c5-132">Provides in-store filtering using a local ML model that only captures images of people for analysis.</span></span> <span data-ttu-id="b24c5-133">Bezpiecznie obsługiwane i aktualizowane za IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="b24c5-133">Securely provisioned and updated through IoT Hub.</span></span><br><br>|
| <span data-ttu-id="b24c5-134">Azure</span><span class="sxs-lookup"><span data-stu-id="b24c5-134">Azure</span></span> | [<span data-ttu-id="b24c5-135">Azure Event Hubs</span><span class="sxs-lookup"><span data-stu-id="b24c5-135">Azure Event Hubs</span></span>](/azure/event-hubs/) | <span data-ttu-id="b24c5-136">Usługa Azure Event Hubs zapewnia skalowalną platformę do pozyskiwania danych anonimowe, które są zintegrowane z Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="b24c5-136">Azure Event Hubs provides a scalable platform for ingesting anonymized data that integrates neatly with Azure Stream Analytics.</span></span> |
|  | [<span data-ttu-id="b24c5-137">Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="b24c5-137">Azure Stream Analytics</span></span>](/azure/stream-analytics/) | <span data-ttu-id="b24c5-138">Zadanie Azure Stream Analytics agreguje dane anonimowe i grupuje je do 15-sekundowego systemu Windows w celu wizualizacji.</span><span class="sxs-lookup"><span data-stu-id="b24c5-138">An Azure Stream Analytics job aggregates the anonymized data and groups it into 15-second windows for visualization.</span></span> |
|  | [<span data-ttu-id="b24c5-139">Microsoft Power BI</span><span class="sxs-lookup"><span data-stu-id="b24c5-139">Microsoft Power BI</span></span>](https://powerbi.microsoft.com/) | <span data-ttu-id="b24c5-140">Power BI zapewnia łatwy w użyciu interfejs nawigacyjny do wyświetlania danych wyjściowych z Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="b24c5-140">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="b24c5-141">Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="b24c5-141">Azure Stack Hub</span></span> | [<span data-ttu-id="b24c5-142">App Service</span><span class="sxs-lookup"><span data-stu-id="b24c5-142">App Service</span></span>](/azure-stack/operator/azure-stack-app-service-overview) | <span data-ttu-id="b24c5-143">Dostawca zasobów App Service (RP) stanowi podstawę dla składników brzegowych, w tym funkcje hostingu i zarządzania dla aplikacji sieci Web/interfejsów API i funkcji.</span><span class="sxs-lookup"><span data-stu-id="b24c5-143">The App Service resource provider (RP) provides a base for edge components, including hosting and management features for web apps/APIs and Functions.</span></span> |
| | <span data-ttu-id="b24c5-144">Klaster aparatu usługi Azure Kubernetes Service [(AKS)](https://github.com/Azure/aks-engine)</span><span class="sxs-lookup"><span data-stu-id="b24c5-144">Azure Kubernetes Service [(AKS) Engine](https://github.com/Azure/aks-engine) cluster</span></span> | <span data-ttu-id="b24c5-145">AKS RP z klastrem AKS-Engine wdrożonym w usłudze Azure Stack Hub zapewnia skalowalny, odporny na awarię aparat do uruchamiania kontenera Face API.</span><span class="sxs-lookup"><span data-stu-id="b24c5-145">The AKS RP with AKS-Engine cluster deployed into Azure Stack Hub provides a scalable, resilient engine to run the Face API container.</span></span> |
| | <span data-ttu-id="b24c5-146">[Kontenery Face API](/azure/cognitive-services/face/face-how-to-install-containers) Cognitive Services platformy Azure</span><span class="sxs-lookup"><span data-stu-id="b24c5-146">Azure Cognitive Services [Face API containers](/azure/cognitive-services/face/face-how-to-install-containers)</span></span>| <span data-ttu-id="b24c5-147">Usługa Azure Cognitive Services RP z kontenerami Face API oferuje funkcje demograficzne, rozpoznawania emocji i unikatowe wykrywanie użytkowników w sieci prywatnej firmy Contoso.</span><span class="sxs-lookup"><span data-stu-id="b24c5-147">The Azure Cognitive Services RP with Face API containers provides demographic, emotion, and unique visitor detection on Contoso's private network.</span></span> |
| | <span data-ttu-id="b24c5-148">Blob Storage</span><span class="sxs-lookup"><span data-stu-id="b24c5-148">Blob Storage</span></span> | <span data-ttu-id="b24c5-149">Obrazy przechwycone z zestawu AI, są przekazywane do magazynu obiektów Blob Azure Stack Hub.</span><span class="sxs-lookup"><span data-stu-id="b24c5-149">Images captured from the AI Dev Kit are uploaded to Azure Stack Hub's blob storage.</span></span> |
| | <span data-ttu-id="b24c5-150">Azure Functions</span><span class="sxs-lookup"><span data-stu-id="b24c5-150">Azure Functions</span></span> | <span data-ttu-id="b24c5-151">Funkcja platformy Azure działająca w systemie Azure Stack Hub otrzymuje dane wejściowe z usługi BLOB Storage i zarządza interakcjami z Face API.</span><span class="sxs-lookup"><span data-stu-id="b24c5-151">An Azure Function running on Azure Stack Hub receives input from blob storage and manages the interactions with the Face API.</span></span> <span data-ttu-id="b24c5-152">Emituje dane anonimowe do klastra Event Hubs znajdującego się na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="b24c5-152">It emits anonymized data to an Event Hubs cluster located in Azure.</span></span><br><br>|

## <a name="issues-and-considerations"></a><span data-ttu-id="b24c5-153">Problemy i kwestie do rozważenia</span><span class="sxs-lookup"><span data-stu-id="b24c5-153">Issues and considerations</span></span>

<span data-ttu-id="b24c5-154">Podczas decydowania o sposobie wdrożenia tego rozwiązania należy wziąć pod uwagę następujące kwestie:</span><span class="sxs-lookup"><span data-stu-id="b24c5-154">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="b24c5-155">Skalowalność</span><span class="sxs-lookup"><span data-stu-id="b24c5-155">Scalability</span></span>

<span data-ttu-id="b24c5-156">Aby umożliwić skalowanie tego rozwiązania między wieloma aparatami i lokalizacjami, należy upewnić się, że wszystkie składniki mogą obsłużyć zwiększone obciążenie.</span><span class="sxs-lookup"><span data-stu-id="b24c5-156">To enable this solution to scale across multiple cameras and locations, you'll need to make sure that all of the components can handle the increased load.</span></span> <span data-ttu-id="b24c5-157">Może być konieczne wykonanie działań takich jak:</span><span class="sxs-lookup"><span data-stu-id="b24c5-157">You may need to take actions like:</span></span>

- <span data-ttu-id="b24c5-158">Zwiększ liczbę Stream Analytics jednostek przesyłania strumieniowego.</span><span class="sxs-lookup"><span data-stu-id="b24c5-158">Increase the number of Stream Analytics streaming units.</span></span>
- <span data-ttu-id="b24c5-159">Skaluj w poziomie wdrożenie Face API.</span><span class="sxs-lookup"><span data-stu-id="b24c5-159">Scale out the Face API deployment.</span></span>
- <span data-ttu-id="b24c5-160">Zwiększ przepływność klastra Event Hubs.</span><span class="sxs-lookup"><span data-stu-id="b24c5-160">Increase the Event Hubs cluster throughput.</span></span>
- <span data-ttu-id="b24c5-161">W skrajnych przypadkach może być konieczne przeprowadzenie migracji z Azure Functions na maszynę wirtualną.</span><span class="sxs-lookup"><span data-stu-id="b24c5-161">For extreme cases, migrate from Azure Functions to a virtual machine may be necessary.</span></span>

### <a name="availability"></a><span data-ttu-id="b24c5-162">Dostępność</span><span class="sxs-lookup"><span data-stu-id="b24c5-162">Availability</span></span>

<span data-ttu-id="b24c5-163">Ponieważ to rozwiązanie jest warstwowe, należy wziąć pod uwagę sposób postępowania z awariami sieci lub zasilaczem.</span><span class="sxs-lookup"><span data-stu-id="b24c5-163">Since this solution is tiered, it's important to think about how to deal with networking or power failures.</span></span> <span data-ttu-id="b24c5-164">W zależności od potrzeb firmy można zaimplementować mechanizm buforowania obrazów lokalnie, a następnie przesłać do Azure Stack Hub, gdy połączenie zwróci wartość.</span><span class="sxs-lookup"><span data-stu-id="b24c5-164">Depending on business needs, you might want to implement a mechanism to cache images locally, then forward to Azure Stack Hub when connectivity returns.</span></span> <span data-ttu-id="b24c5-165">Jeśli lokalizacja jest wystarczająco duża, wdrożenie Data Box Edge z kontenerem Face API do tej lokalizacji może być lepszym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="b24c5-165">If the location is large enough, deploying a Data Box Edge with the Face API container to that location might be a better option.</span></span>

### <a name="manageability"></a><span data-ttu-id="b24c5-166">Możliwości zarządzania</span><span class="sxs-lookup"><span data-stu-id="b24c5-166">Manageability</span></span>

<span data-ttu-id="b24c5-167">To rozwiązanie może obejmować wiele urządzeń i lokalizacji, które mogą uzyskać nieporęczny.</span><span class="sxs-lookup"><span data-stu-id="b24c5-167">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="b24c5-168">[Usługi IoT platformy Azure](/azure/iot-fundamentals/) mogą służyć do automatycznego przenoszenia nowych lokalizacji i urządzeń w tryb online oraz do ich Aktualności.</span><span class="sxs-lookup"><span data-stu-id="b24c5-168">[Azure's IoT services](/azure/iot-fundamentals/) can be used to automatically bring new locations and devices online and keep them up to date.</span></span>

### <a name="security"></a><span data-ttu-id="b24c5-169">Zabezpieczenia</span><span class="sxs-lookup"><span data-stu-id="b24c5-169">Security</span></span>

<span data-ttu-id="b24c5-170">To rozwiązanie służy do przechwytywania obrazów klientów, co sprawia, że zabezpieczenia są najważniejsze.</span><span class="sxs-lookup"><span data-stu-id="b24c5-170">This solution captures customer images, making security a paramount consideration.</span></span> <span data-ttu-id="b24c5-171">Upewnij się, że wszystkie konta magazynu są zabezpieczone przy użyciu odpowiednich zasad dostępu i regularnie Obróć klucze.</span><span class="sxs-lookup"><span data-stu-id="b24c5-171">Make sure all storage accounts are secured with the proper access policies and rotate keys regularly.</span></span> <span data-ttu-id="b24c5-172">Upewnij się, że konta magazynu i Event Hubs mają zasady przechowywania spełniające przepisy w zakresie ochrony prywatności dla firm i instytucji rządowych.</span><span class="sxs-lookup"><span data-stu-id="b24c5-172">Ensure storage accounts and Event Hubs have retention policies that meet corporate and government privacy regulations.</span></span> <span data-ttu-id="b24c5-173">Należy również pamiętać o warstwach poziomów dostępu użytkowników.</span><span class="sxs-lookup"><span data-stu-id="b24c5-173">Also make sure to tier the user access levels.</span></span> <span data-ttu-id="b24c5-174">Obsługa warstw gwarantuje, że użytkownicy będą mieli dostęp tylko do danych, które są im potrzebne do ich roli.</span><span class="sxs-lookup"><span data-stu-id="b24c5-174">Tiering ensures that users only have access to the data they need for their role.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b24c5-175">Następne kroki</span><span class="sxs-lookup"><span data-stu-id="b24c5-175">Next steps</span></span>

<span data-ttu-id="b24c5-176">Aby dowiedzieć się więcej na temat tematów wprowadzonych w tym artykule:</span><span class="sxs-lookup"><span data-stu-id="b24c5-176">To learn more about the topics introduced in this article:</span></span>

- <span data-ttu-id="b24c5-177">Zobacz [wzorzec danych warstwowych](https://aka.ms/tiereddatadeploy), który jest używany przez wzorzec wykrywania FootFall.</span><span class="sxs-lookup"><span data-stu-id="b24c5-177">See the [Tiered Data pattern](https://aka.ms/tiereddatadeploy), which is leveraged by the footfall detection pattern.</span></span>
- <span data-ttu-id="b24c5-178">Aby dowiedzieć się więcej o używaniu niestandardowej wizji, zobacz temat [Custom Vision AI dev Kit](https://azure.github.io/Vision-AI-DevKit-Pages/) .</span><span class="sxs-lookup"><span data-stu-id="b24c5-178">See the [Custom Vision AI Dev Kit](https://azure.github.io/Vision-AI-DevKit-Pages/) to learn more about using custom vision.</span></span> 

<span data-ttu-id="b24c5-179">Gdy wszystko będzie gotowe do testowania przykładowego rozwiązania, przejdź do [przewodnika po wdrożeniu wykrywania FootFall](solution-deployment-guide-retail-footfall-detection.md).</span><span class="sxs-lookup"><span data-stu-id="b24c5-179">When you're ready to test the solution example, continue with the [Footfall detection deployment guide](solution-deployment-guide-retail-footfall-detection.md).</span></span> <span data-ttu-id="b24c5-180">Przewodnik wdrażania zawiera instrukcje krok po kroku dotyczące wdrażania i testowania jego składników.</span><span class="sxs-lookup"><span data-stu-id="b24c5-180">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
